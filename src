<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>

<body>
    <section class="vh-100 gradient-custom">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col col-xl-10">

                    <div class="card">
                        <div class="card-body p-5">

                            <form id="groceryForm" class="d-flex justify-content-center align-items-center mb-4">
                                <div class="form-outline flex-fill">
                                    <label class="form-label mb-1" for="form2">Item Name</label>
                                    <input type="text" id="itemName" class="form-control" />
                                </div>
                                <div class="form-outline flex-fill">
                                    <label class="form-label mb-1" for="quantity">Quantity</label>
                                    <input type="number" id="Quantity" class="form-control" />
                                </div>
                                <button type="submit" class="btn btn-info mt-4 ms-2">Add</button>
                            </form>

                            <div class="card-body p-5">

                                <h3 class="mt-4">All Items</h3>
                                <ul class="list-group mb-0">
                                    <!--Item List-->
                                </ul>

                                <h3 class="mt-4">Removed Items</h3>
                                <ul class="list-group mb-0" id="removedItemsList">
                                    <!--Removed Item List-->
                                </ul>
                                <button id="clearButton" class="btn btn-warning mt-2">Clear Removed Items</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        </div>
        </div>
        </div>
    </section>
    <script src="index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
</body>

</html>


let itemsArray = [];
let removedItemsArray = [];

document.getElementById('groceryForm').addEventListener('submit', function(e){
    e.preventDefault();

    let itemName = document.getElementById('itemName').value;
    let quantity = document.getElementById('Quantity').value;

    itemsArray.push({name: itemName, quantity: quantity});

    let newItem = createListItem(itemName, quantity);
    document.querySelector('#allItemsList').appendChild(newItem);
});

document.getElementById('clearRemovedItems').addEventListener('click', function(e){
    removedItemsArray = [];
    document.querySelector('#removedItemsList').innerHTML = "";
});

function createListItem(itemName, quantity, isRemoved=false) {
    let newItem = document.createElement('li');
    newItem.classList.add('list-group-item', 'd-flex', 'justify-content-between', 'align-items-center', 'border-0', 'mb-2', 'rounded');
    newItem.style.backgroundColor = "#f4f6f7";

    let itemDetails = document.createElement('div');
    itemDetails.classList.add('d-flex', 'align-items-center');

    if(!isRemoved) {
        let checkbox = document.createElement('input');
        checkbox.classList.add('form-check-input', 'me-2');
        checkbox.type = 'checkbox';
        checkbox.value = '';
        checkbox.setAttribute('aria-label', '...');

        checkbox.addEventListener('change', function(e) {
            if(e.target.checked) {
                let index = itemsArray.findIndex(i => i.name === itemName && i.quantity === quantity);
                if (index !== -1) {
                    let removedItem = itemsArray.splice(index, 1)[0];
                    removedItemsArray.push(removedItem);

                    let removedListItem = createListItem(itemName, quantity, true);
                    document.querySelector('#removedItemsList').appendChild(removedListItem);
                    e.target.parentElement.parentElement.remove();
                }
            }
        });

        itemDetails.appendChild(checkbox);
    }

    let itemText = document.createElement('span');
    itemText.textContent = `${itemName} (${quantity})`;
    itemDetails.appendChild(itemText);

    if(!isRemoved) {
        let removeButton = document.createElement('button');
        removeButton.classList.add('btn', 'btn-danger', 'btn-sm');
        removeButton.textContent = 'Remove';

        removeButton.addEventListener('click', function(e) {
            let index = itemsArray.findIndex(i => i.name === itemName && i.quantity === quantity);
            if (index !== -1) {
                let removedItem = itemsArray.splice(index, 1)[0];
                removedItemsArray.push(removedItem);

                let removedListItem = createListItem(itemName, quantity, true);
                document.querySelector('#removedItemsList').appendChild(removedListItem);
                e.target.parentElement.remove();
            }
        });

        newItem.appendChild(removeButton);
    }

    newItem.appendChild(itemDetails);

    return newItem;
}
